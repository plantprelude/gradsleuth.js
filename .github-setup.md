# GitHub Repository Setup Guide

This document provides instructions for configuring GitHub repository settings, branch protection rules, and workflows.

## Table of Contents

- [Branch Protection Rules](#branch-protection-rules)
- [Repository Settings](#repository-settings)
- [GitHub Actions Setup](#github-actions-setup)
- [Optional Enhancements](#optional-enhancements)

---

## Branch Protection Rules

Branch protection rules ensure code quality and prevent accidental changes to important branches. These settings must be configured through the GitHub web interface.

### How to Set Up Branch Protection

1. Go to your repository on GitHub
2. Click **Settings** → **Branches** → **Add branch protection rule**
3. Configure rules for each branch as described below

### Protection Rules for `main`

**Branch name pattern**: `main`

**Recommended Settings** (for team collaboration):
- ✅ **Require a pull request before merging**
  - Required approvals: **1** (increase to 2 when team grows)
  - ✅ Dismiss stale pull request approvals when new commits are pushed
  - ✅ Require review from Code Owners (when CODEOWNERS file exists)

- ✅ **Require status checks to pass before merging** (when CI is set up)
  - ✅ Require branches to be up to date before merging
  - Status checks to require:
    - `test` (when test suite exists)
    - `build` (when build process exists)
    - `lint` (when linting is set up)

- ✅ **Require conversation resolution before merging**

- ✅ **Require signed commits** (optional, for extra security)

- ✅ **Include administrators** (enforce rules for everyone)

- ✅ **Restrict pushes that create matching branches**

- ✅ **Do not allow bypassing the above settings**

**Current Stage Settings** (single developer, no PR requirement):
- ⬜ Require a pull request before merging (disabled for now)
- ✅ Include administrators
- ⬜ Other settings (enable when team grows)

### Protection Rules for `develop`

**Branch name pattern**: `develop`

**Recommended Settings** (for team collaboration):
- ✅ **Require a pull request before merging**
  - Required approvals: **1**

- ✅ **Require status checks to pass before merging**
  - Status checks to require:
    - `test`
    - `build`

- ✅ **Require conversation resolution before merging**

- ✅ **Allow force pushes** (by specific people/teams only)

- ✅ **Allow deletions** (disabled)

**Current Stage Settings** (single developer):
- ⬜ No protection rules required yet
- ✅ Keep branch protection minimal for flexibility
- Enable rules when collaborating with others

### Protection Rules for Feature Branches

**Branch name pattern**: `feature/*`

**Recommended Settings**:
- ⬜ No strict protection needed
- ✅ Automatically delete after merge (GitHub repository setting)
- Developers can manage their own feature branches

---

## Repository Settings

### General Settings

Navigate to **Settings** → **General**

#### Default Branch
- Set default branch: **`develop`**
  - This ensures PRs and clones default to the development branch

#### Pull Requests
- ✅ Allow merge commits
- ✅ Allow squash merging
- ✅ Allow rebase merging
- ✅ Automatically delete head branches (cleans up merged feature branches)
- ✅ Always suggest updating pull request branches

#### Issues
- ✅ Enable issues
- Set up issue templates (optional, see below)

#### Discussions
- ⬜ Disable for now (enable when community grows)

### Collaborators and Teams

Navigate to **Settings** → **Collaborators and teams**

**Current Stage**: Single developer
- No additional collaborators needed

**Future**: When adding team members
- **Admin**: Project lead
- **Write**: Core developers
- **Read**: External contributors

### Webhooks and Services

**Current Stage**: None needed

**Future**: When deploying
- Add webhooks for:
  - Deployment services (Vercel, Netlify, etc.)
  - CI/CD pipelines
  - Monitoring services

---

## GitHub Actions Setup

### Create Workflow Files

Create `.github/workflows/` directory with the following workflow files:

#### 1. CI Workflow (`.github/workflows/ci.yml`)

```yaml
name: Continuous Integration

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [16.x, 18.x, 20.x]

    steps:
      - uses: actions/checkout@v4

      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run linter
        run: npm run lint

      - name: Run tests
        run: npm test

      - name: Build
        run: npm run build

  code-quality:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Run ESLint
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'

      - run: npm ci
      - run: npm run lint
```

#### 2. Dependency Updates (`.github/dependabot.yml`)

```yaml
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
    reviewers:
      - "plantprelude"  # Your GitHub username
    labels:
      - "dependencies"
      - "automated"
```

**Note**: These workflows will be activated once you add the corresponding npm scripts in `package.json` (e.g., `test`, `lint`, `build`).

---

## Optional Enhancements

### Issue Templates

Create `.github/ISSUE_TEMPLATE/` with templates for:

#### Bug Report (`.github/ISSUE_TEMPLATE/bug_report.md`)
```markdown
---
name: Bug report
about: Create a report to help us improve
title: '[BUG] '
labels: bug
assignees: ''
---

**Describe the bug**
A clear description of what the bug is.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '...'
3. See error

**Expected behavior**
What you expected to happen.

**Screenshots**
If applicable, add screenshots.

**Environment:**
 - OS: [e.g. macOS, Windows, Linux]
 - Browser: [e.g. Chrome, Firefox]
 - Version: [e.g. 22]
```

#### Feature Request (`.github/ISSUE_TEMPLATE/feature_request.md`)
```markdown
---
name: Feature request
about: Suggest an idea for this project
title: '[FEATURE] '
labels: enhancement
assignees: ''
---

**Is your feature request related to a problem?**
A clear description of the problem.

**Describe the solution you'd like**
A clear description of what you want to happen.

**Describe alternatives you've considered**
Alternative solutions or features you've considered.

**Additional context**
Any other context or screenshots.
```

### Pull Request Template

Create `.github/pull_request_template.md`:

```markdown
## Summary
Brief description of what this PR does.

## Type of Change
- [ ] Bug fix
- [ ] New feature
- [ ] Breaking change
- [ ] Documentation update
- [ ] Refactoring
- [ ] Performance improvement

## Changes Made
- List specific changes
- Another change
- One more change

## Testing
Describe how you tested these changes:
- [ ] Tested locally
- [ ] Added unit tests
- [ ] Tested in multiple browsers
- [ ] Checked responsive design

## Screenshots (if applicable)
Add before/after screenshots for UI changes.

## Checklist
- [ ] Code follows project style guidelines
- [ ] Self-review completed
- [ ] Comments added for complex code
- [ ] Documentation updated
- [ ] No new warnings generated
- [ ] Tests pass locally
- [ ] No sensitive data committed

## Related Issues
Closes #issue_number
```

### Security Policy

Create `SECURITY.md`:

```markdown
# Security Policy

## Reporting a Vulnerability

If you discover a security vulnerability, please email ejstronge@gmail.com with:

1. Description of the vulnerability
2. Steps to reproduce
3. Potential impact
4. Suggested fix (if any)

Please do NOT create a public GitHub issue for security vulnerabilities.

## Supported Versions

| Version | Supported          |
| ------- | ------------------ |
| 0.1.x   | :white_check_mark: |
| < 0.1   | :x:                |

## Security Measures

- All dependencies regularly updated
- Input validation on all user inputs
- SQL injection prevention via parameterized queries
- XSS protection enabled
- HTTPS only in production
- Secrets never committed to repository
```

### Code Owners

Create `.github/CODEOWNERS` (for future team collaboration):

```
# Default owners for everything
* @plantprelude

# When team grows:
# /packages/ml-services/ @ml-team
# /packages/web-frontend/ @frontend-team
# /packages/data-collectors/ @data-team
# /.github/ @devops-team
```

---

## Implementation Checklist

Use this checklist to track your GitHub setup:

### Essential (Do Now)
- [ ] Set `develop` as default branch
- [ ] Enable "Automatically delete head branches"
- [ ] Review repository visibility (public/private)
- [ ] Add repository description and topics

### When Team Grows
- [ ] Set up branch protection for `main`
- [ ] Set up branch protection for `develop`
- [ ] Add collaborators with appropriate permissions
- [ ] Create issue templates
- [ ] Create PR template
- [ ] Set up CODEOWNERS

### When Adding CI/CD
- [ ] Create GitHub Actions workflows
- [ ] Set up Dependabot
- [ ] Configure required status checks in branch protection
- [ ] Set up deployment workflows

### Nice to Have
- [ ] Add repository social image
- [ ] Set up GitHub Discussions (when community exists)
- [ ] Configure GitHub Pages (for documentation)
- [ ] Add repository badges to README

---

## Quick Setup Commands

Since you can't set all these via CLI, here's how to access the settings:

```bash
# Open repository settings in browser
open "https://github.com/plantprelude/gradsleuth.js/settings"

# Open branch protection settings
open "https://github.com/plantprelude/gradsleuth.js/settings/branches"

# Open Actions settings
open "https://github.com/plantprelude/gradsleuth.js/settings/actions"
```

Or manually navigate to: `Repository → Settings → [Section]`

---

## Notes

- **Current stage**: Minimal protection for development flexibility
- **When to enable strict rules**: When collaborating or before production
- **Review regularly**: As project evolves, update these settings
- **Document changes**: Keep this file updated with actual configuration

---

**Last Updated**: November 2024
**Next Review**: When adding first team member or before v0.1.0 release
